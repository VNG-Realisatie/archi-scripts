load(__DIR__ + "../lib/papaparse.min.js");

var papaparseConfig = {
	// delimiter: "",	// auto-detect
	// newline: "",	// auto-detect
	// quoteChar: '"',
	// escapeChar: '"',
	// header: false,
	// transformHeader: undefined,
	// dynamicTyping: false,
	preview: 7,
	// encoding: "",
	// worker: false,
	// comments: false,
	// step: undefined,
	// complete: undefined,
	// error: undefined,
	// download: false,
	// downloadRequestHeaders: undefined,
	// skipEmptyLines: false,
	// chunk: undefined,
	// fastMode: undefined,
	// beforeFirstChunk: undefined,
	// withCredentials: undefined,
	// transform: undefined,
	delimitersToGuess: [',', '\t', '|', ';', Papa.RECORD_SEP, Papa.UNIT_SEP]
}


/*
var fileInput = {
	files: "C:\\D-schijf\\Data\\Dropbox\\KING\\KING ICT\\Archi\\Informatiebeveiliging\\GEMMA 2-IB AF-elements corrected.csv"
}

fileInput.files[0] = window.promptOpenFile({ title: "Open CSV with " , filterExtensions: ["*.CSV"], fileName: "*.csv" });
console.log(fileInput.files[0]);

Papa.parse(fileInput.files[0], {
	header: true,
	complete: function(results) {
		console.log(results);
		for (var parseObjects in results) {
			console.log("In results : " + parseObjects);
			for (var regel in parseObjects) {
				console.log("In results.regel : " + regel);
			}
		}
		console.log(results.data[i]);
		for (var i=0; i<results.data.length; i++) {
			console.log(results.data[i]);
		}
	}
});
*/

var filePath =  "C:\\D-schijf\\Data\\Dropbox\\KING\\KING ICT\\Archi\\Informatiebeveiliging\\GEMMA 2-IB AF-elements corrected.csv";
var FileReader = Java.type("java.io.FileReader");
var InputStreamReader = Java.type("java.io.InputStreamReader");
var FileInputStream = Java.type("java.io.FileInputStream");
var theCSVFile = new InputStreamReader(new FileInputStream(filePath), "UTF-8");
var theCSV ="";

var data = theCSVFile.read();
console.log("> Please Wait...");

while(data != -1) {
	var theCharacter = String.fromCharCode(data);
	theCSV+=theCharacter;
	data = theCSVFile.read(); 
}
theCSVFile.close();

console.log("> File Loaded");

Papa.parse(theCSV,  {
	header: true,
	step: function(row) {
		console.log("Row :  ", row.data["Element label"],  row.data["Toelichting"]);
	},
	complete: function(results) {
		console.log("All done!", results);
	}
});